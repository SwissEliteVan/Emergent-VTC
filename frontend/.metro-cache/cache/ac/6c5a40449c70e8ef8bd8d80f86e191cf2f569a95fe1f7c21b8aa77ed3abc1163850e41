{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":91},"end":{"line":2,"column":69,"index":160}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":162},"end":{"line":3,"column":47,"index":209}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"expo-linking","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":211},"end":{"line":4,"column":40,"index":251}}],"key":"UOn5wJuCXvTT9EneNUmI6H0GQgM=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":295},"end":{"line":6,"column":26,"index":321}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":323},"end":{"line":7,"column":39,"index":362}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"3suYSPX9nHbHZ1xNTsKXtKj0atE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,_d){\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}function t(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),t.default=e,t}Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,\"AuthProvider\",{enumerable:!0,get:function(){return h}}),Object.defineProperty(_e,\"useAuth\",{enumerable:!0,get:function(){return _}});var n=r(_d[0]),o=e(r(_d[1])),s=(t(r(_d[2])),t(r(_d[3])));r(_d[4]);var u=e(r(_d[5])),c=e(r(_d[6])),l=r(_d[7]);const d=c.default.expoConfig?.extra?.EXPO_PUBLIC_BACKEND_URL||process.env.EXPO_PUBLIC_BACKEND_URL,f=(0,n.createContext)(void 0),h=({children:e})=>{const[t,c]=(0,n.useState)(null),[h,_]=(0,n.useState)(null),[p,y]=(0,n.useState)(!0);(0,n.useEffect)(()=>{v()},[]),(0,n.useEffect)(()=>{const e=s.addEventListener('url',async e=>{await w(e.url)});return s.getInitialURL().then(e=>{e&&w(e)}),()=>{e.remove()}},[]);const v=async()=>{try{const e=await o.default.getItem('session_token');if(e){const t=await u.default.get(`${d}/api/auth/me`,{headers:{Authorization:`Bearer ${e}`}});c(t.data),_(e)}}catch(e){console.log('No valid session found'),await o.default.removeItem('session_token')}finally{y(!1)}},w=async e=>{try{const t=e.match(/[#?]session_id=([^&]+)/);if(!t)return;const n=t[1];y(!0);const s=await u.default.post(`${d}/api/auth/session`,{},{headers:{'X-Session-ID':n}}),{session_token:l,user_id:f,email:h,name:p,picture:v,role:w}=s.data;await o.default.setItem('session_token',l),_(l),c({user_id:f,email:h,name:p,picture:v,role:w});'true'===await o.default.getItem('pending_booking_intent')&&await o.default.removeItem('pending_booking_intent')}catch(e){console.error('Auth callback error:',e)}finally{y(!1)}},b=!t&&!p;return(0,l.jsx)(f.Provider,{value:{user:t,sessionToken:h,loading:p,isGuest:b,login:async()=>{try{const e=`${d}/`,t=`https://auth.emergentagent.com/?redirect=${encodeURIComponent(e)}`;window.location.href=t}catch(e){console.error('Login error:',e)}},logout:async()=>{try{h&&await u.default.post(`${d}/api/auth/logout`,{},{headers:{Authorization:`Bearer ${h}`}})}catch(e){console.error('Logout error:',e)}finally{await o.default.removeItem('session_token'),c(null),_(null)}}},children:e})},_=()=>{const e=(0,n.useContext)(f);if(!e)throw new Error('useAuth must be used within AuthProvider');return e}});","lineCount":1,"map":[[1,378,30,0,"Object"],[1,385,30,0,"defineProperty"],[1,400,30,0,"_e"],[1,403,30,0],[1,419,30,0,"enumerable"],[1,431,30,0],[1,433,30,0,"get"],[1,437,30,0],[1,455,30,0,"AuthProvider"],[1,456,30,0],[1,460,163,0,"Object"],[1,467,163,0,"defineProperty"],[1,482,163,0,"_e"],[1,485,163,0],[1,496,163,0,"enumerable"],[1,508,163,0],[1,510,163,0,"get"],[1,514,163,0],[1,532,163,0,"useAuth"],[1,533,163,0],[1,537,1,0],[1,541,1,0,"_react"],[1,543,1,0,"r"],[1,545,1,0,"_d"],[1,548,1,0],[1,552,2,0,"AsyncStorage"],[1,554,2,0,"_interopDefault"],[1,556,2,0,"r"],[1,558,2,0,"_d"],[1,561,2,0],[1,566,4,0,"Linking"],[1,569,3,0,"_interopNamespace"],[1,571,3,0,"r"],[1,573,3,0,"_d"],[1,576,3,0],[1,581,4,0,"_interopNamespace"],[1,583,4,0,"r"],[1,585,4,0,"_d"],[1,588,4,0],[1,594,4,40,"r"],[1,596,4,40,"_d"],[1,599,4,40],[1,603,6,0],[1,607,6,0,"axios"],[1,609,6,0,"_interopDefault"],[1,611,6,0,"r"],[1,613,6,0,"_d"],[1,616,6,0],[1,621,7,0,"Constants"],[1,623,7,0,"_interopDefault"],[1,625,7,0,"r"],[1,627,7,0,"_d"],[1,630,7,0],[1,635,7,39,"_reactJsxRuntime"],[1,637,7,39,"r"],[1,639,7,39,"_d"],[1,642,7,39],[1,646,9,0],[1,652,9,6,"BACKEND_URL"],[1,654,9,20,"Constants"],[1,656,9,29,"default"],[1,664,9,30,"expoConfig"],[1,676,9,42,"extra"],[1,683,9,49,"EXPO_PUBLIC_BACKEND_URL"],[1,708,9,76,"process"],[1,716,9,84,"env"],[1,720,9,88,"EXPO_PUBLIC_BACKEND_URL"],[1,744,28,6,"AuthContext"],[1,747,28,20],[1,749,28,20,"createContext"],[1,751,28,33,"createContext"],[1,771,28,63,"undefined"],[1,774,30,13,"AuthProvider"],[1,776,30,28,"AuthProvider"],[1,778,30,31,"children"],[1,793,31,2],[1,799,31,9,"user"],[1,801,31,15,"setUser"],[1,805,31,26],[1,807,31,26,"useState"],[1,809,31,34,"useState"],[1,819,31,48],[1,826,32,9,"sessionToken"],[1,828,32,23,"setSessionToken"],[1,832,32,42],[1,834,32,42,"useState"],[1,836,32,50,"useState"],[1,846,32,66],[1,853,33,9,"loading"],[1,855,33,18,"setLoading"],[1,859,33,32],[1,861,33,32,"useState"],[1,863,33,40,"useState"],[1,874,33,41],[1,878,36,2],[1,880,36,2,"useEffect"],[1,882,36,11,"useEffect"],[1,893,36,12],[1,898,37,4,"checkExistingSession"],[1,903,38,5],[1,908,41,2],[1,910,41,2,"useEffect"],[1,912,41,11,"useEffect"],[1,923,41,12],[1,928,42,4],[1,934,46,10,"subscription"],[1,936,46,25,"Linking"],[1,938,46,33,"addEventListener"],[1,955,46,50],[1,961,42,27,"async"],[1,977,43,12,"processAuthCallback"],[1,979,43,32,"event"],[1,981,43,38,"url"],[1,988,55,4],[1,995,49,4,"Linking"],[1,997,49,12,"getInitialURL"],[1,1013,49,28,"then"],[1,1018,49,34,"url"],[1,1022,50,10,"url"],[1,1025,51,8,"processAuthCallback"],[1,1027,51,28,"url"],[1,1032,55,11],[1,1037,56,6,"subscription"],[1,1039,56,19,"remove"],[1,1050,58,5],[1,1054,60,2],[1,1060,60,8,"checkExistingSession"],[1,1062,60,31,"async"],[1,1072,61,4],[1,1076,62,6],[1,1082,62,12,"token"],[1,1090,62,26,"AsyncStorage"],[1,1092,62,38,"default"],[1,1100,62,39,"getItem"],[1,1108,62,47],[1,1125,63,6],[1,1128,63,10,"token"],[1,1130,63,17],[1,1131,65,8],[1,1137,65,14,"response"],[1,1145,65,31,"axios"],[1,1147,65,36,"default"],[1,1155,65,37,"get"],[1,1159,65,41],[1,1162,65,44,"BACKEND_URL"],[1,1178,65,71],[1,1179,66,10,"headers"],[1,1187,66,19],[1,1188,66,21,"Authorization"],[1,1202,66,36],[1,1212,66,46,"token"],[1,1219,68,8,"setUser"],[1,1221,68,16,"response"],[1,1223,68,25,"data"],[1,1229,69,8,"setSessionToken"],[1,1231,69,24,"token"],[1,1233,70,6],[1,1234,71,4],[1,1235,71,6],[1,1241,71,13,"error"],[1,1244,72,6,"console"],[1,1252,72,14,"log"],[1,1256,72,18],[1,1288,73,12,"AsyncStorage"],[1,1290,73,24,"default"],[1,1298,73,25,"removeItem"],[1,1309,73,36],[1,1325,74,4],[1,1326,74,5],[1,1334,75,6,"setLoading"],[1,1337,75,17],[1,1339,76,4],[1,1342,79,8,"processAuthCallback"],[1,1344,79,30,"async"],[1,1354,80,4],[1,1358,82,6],[1,1364,82,12,"sessionIdMatch"],[1,1366,82,29,"url"],[1,1368,82,33,"match"],[1,1374,82,39],[1,1400,83,6],[1,1404,83,11,"sessionIdMatch"],[1,1406,83,27],[1,1413,85,6],[1,1419,85,12,"sessionId"],[1,1421,85,24,"sessionIdMatch"],[1,1423,85,39],[1,1426,86,6,"setLoading"],[1,1429,86,17],[1,1432,89,6],[1,1438,89,12,"response"],[1,1446,89,29,"axios"],[1,1448,89,34,"default"],[1,1456,89,35,"post"],[1,1461,90,8],[1,1464,90,11,"BACKEND_URL"],[1,1485,91,8],[1,1486,91,9],[1,1488,92,8],[1,1489,92,10,"headers"],[1,1497,92,19],[1,1498,92,21],[1,1513,92,37,"sessionId"],[1,1519,95,12,"session_token"],[1,1533,95,14,"session_token"],[1,1535,95,27,"user_id"],[1,1543,95,29,"user_id"],[1,1545,95,36,"email"],[1,1551,95,38,"email"],[1,1553,95,43,"name"],[1,1558,95,45,"name"],[1,1560,95,49,"picture"],[1,1568,95,51,"picture"],[1,1570,95,58,"role"],[1,1575,95,60,"role"],[1,1578,95,69,"response"],[1,1580,95,78,"data"],[1,1591,98,12,"AsyncStorage"],[1,1593,98,24,"default"],[1,1601,98,25,"setItem"],[1,1609,98,33],[1,1625,98,50,"session_token"],[1,1628,99,6,"setSessionToken"],[1,1630,99,22,"session_token"],[1,1633,100,6,"setUser"],[1,1635,100,14],[1,1636,100,16,"user_id"],[1,1646,100,25,"email"],[1,1654,100,32,"name"],[1,1661,100,38,"picture"],[1,1671,100,47,"role"],[1,1680,104,28],[1,1695,103,34,"AsyncStorage"],[1,1697,103,46,"default"],[1,1705,103,47,"getItem"],[1,1713,103,55],[1,1746,105,14,"AsyncStorage"],[1,1748,105,26,"default"],[1,1756,105,27,"removeItem"],[1,1767,105,38],[1,1792,108,4],[1,1793,108,6],[1,1799,108,13,"error"],[1,1802,109,6,"console"],[1,1810,109,14,"error"],[1,1816,109,20],[1,1839,109,44,"error"],[1,1841,110,4],[1,1842,110,5],[1,1850,111,6,"setLoading"],[1,1853,111,17],[1,1855,112,4],[1,1858,154,8,"isGuest"],[1,1861,154,19,"user"],[1,1865,154,28,"loading"],[1,1867,156,2],[1,1874,157,4],[1,1876,157,4,"_reactJsxRuntime"],[1,1878,157,4,"jsx"],[1,1883,157,5,"AuthContext"],[1,1885,157,17,"Provider"],[1,1894,157,25],[1,1895,157,26,"value"],[1,1901,157,33],[1,1902,157,35,"user"],[1,1909,157,41,"sessionToken"],[1,1924,157,55,"loading"],[1,1934,157,64,"isGuest"],[1,1944,157,73,"login"],[1,1950,115,16,"async"],[1,1960,116,4],[1,1964,117,6],[1,1970,117,12,"redirectUrl"],[1,1972,118,10],[1,1975,118,13,"BACKEND_URL"],[1,1980,121,12,"authUrl"],[1,1982,121,22],[1,2026,121,66,"encodeURIComponent"],[1,2045,121,85,"redirectUrl"],[1,2050,124,8,"window"],[1,2057,124,15,"location"],[1,2066,124,24,"href"],[1,2071,124,31,"authUrl"],[1,2072,131,4],[1,2073,131,6],[1,2079,131,13,"error"],[1,2082,132,6,"console"],[1,2090,132,14,"error"],[1,2096,132,20],[1,2111,132,36,"error"],[1,2113,133,4],[1,2116,157,80,"logout"],[1,2123,136,17,"async"],[1,2133,137,4],[1,2137,138,10,"sessionToken"],[1,2146,139,14,"axios"],[1,2148,139,19,"default"],[1,2156,139,20,"post"],[1,2161,140,10],[1,2164,140,13,"BACKEND_URL"],[1,2184,141,10],[1,2185,141,11],[1,2187,142,10],[1,2188,142,12,"headers"],[1,2196,142,21],[1,2197,142,23,"Authorization"],[1,2211,142,38],[1,2221,142,48,"sessionToken"],[1,2227,145,4],[1,2228,145,6],[1,2234,145,13,"error"],[1,2237,146,6,"console"],[1,2245,146,14,"error"],[1,2251,146,20],[1,2267,146,37,"error"],[1,2269,147,4],[1,2270,147,5],[1,2284,148,12,"AsyncStorage"],[1,2286,148,24,"default"],[1,2294,148,25,"removeItem"],[1,2305,148,36],[1,2322,149,6,"setUser"],[1,2324,149,14],[1,2330,150,6,"setSessionToken"],[1,2332,150,22],[1,2337,151,4],[1,2341,157,89,"children"],[1,2350,158,7,"children"],[1,2355,163,13,"useAuth"],[1,2357,163,23,"useAuth"],[1,2362,164,2],[1,2368,164,8,"context"],[1,2371,164,18],[1,2373,164,18,"useContext"],[1,2375,164,28,"useContext"],[1,2387,164,29,"AuthContext"],[1,2390,165,2],[1,2394,165,7,"context"],[1,2396,166,4],[1,2402,166,10],[1,2406,166,14,"Error"],[1,2412,166,20],[1,2456,168,2],[1,2463,168,9,"context"],[1,2465,169,2],[1,2468]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","handleDeepLink","Linking.getInitialURL.then$argument_0","<anonymous>","checkExistingSession","processAuthCallback","login","logout","useAuth"],"mappings":"AAA;4BC6B;YCM;GDE;YCG;2BCC;KDE;iCEK;KFI;WGE;KHE;GDC;+BKE;GLiB;8BME;GNkC;gBOE;GPmB;iBQE;GRgB;CDS;uBUE;CVM"},"hasCjsExports":false},"type":"js/module"}]}