{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":91},"end":{"line":2,"column":69,"index":160}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":162},"end":{"line":3,"column":47,"index":209}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"expo-linking","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":211},"end":{"line":4,"column":40,"index":251}}],"key":"UOn5wJuCXvTT9EneNUmI6H0GQgM=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":295},"end":{"line":6,"column":26,"index":321}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":323},"end":{"line":7,"column":39,"index":362}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"3suYSPX9nHbHZ1xNTsKXtKj0atE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,_d){\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}function t(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),t.default=e,t}Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,\"AuthProvider\",{enumerable:!0,get:function(){return h}}),Object.defineProperty(_e,\"useAuth\",{enumerable:!0,get:function(){return _}});var n=r(_d[0]),o=e(r(_d[1])),s=(t(r(_d[2])),t(r(_d[3])));r(_d[4]);var u=e(r(_d[5])),c=e(r(_d[6])),l=r(_d[7]);const d=c.default.expoConfig?.extra?.EXPO_PUBLIC_BACKEND_URL||void 0,f=(0,n.createContext)(void 0),h=({children:e})=>{const[t,c]=(0,n.useState)(null),[h,_]=(0,n.useState)(null),[p,y]=(0,n.useState)(!0);(0,n.useEffect)(()=>{v()},[]),(0,n.useEffect)(()=>{const e=s.addEventListener('url',async e=>{await w(e.url)});return s.getInitialURL().then(e=>{e&&w(e)}),()=>{e.remove()}},[]);const v=async()=>{try{const e=await o.default.getItem('session_token');if(e){const t=await u.default.get(`${d}/api/auth/me`,{headers:{Authorization:`Bearer ${e}`}});c(t.data),_(e)}}catch(e){console.log('No valid session found'),await o.default.removeItem('session_token')}finally{y(!1)}},w=async e=>{try{const t=e.match(/[#?]session_id=([^&]+)/);if(!t)return;const n=t[1];y(!0);const s=await u.default.post(`${d}/api/auth/session`,{},{headers:{'X-Session-ID':n}}),{session_token:l,user_id:f,email:h,name:p,picture:v,role:w}=s.data;await o.default.setItem('session_token',l),_(l),c({user_id:f,email:h,name:p,picture:v,role:w});'true'===await o.default.getItem('pending_booking_intent')&&await o.default.removeItem('pending_booking_intent')}catch(e){console.error('Auth callback error:',e)}finally{y(!1)}},b=!t&&!p;return(0,l.jsx)(f.Provider,{value:{user:t,sessionToken:h,loading:p,isGuest:b,login:async()=>{try{const e=`${d}/`,t=`https://auth.emergentagent.com/?redirect=${encodeURIComponent(e)}`;window.location.href=t}catch(e){console.error('Login error:',e)}},logout:async()=>{try{h&&await u.default.post(`${d}/api/auth/logout`,{},{headers:{Authorization:`Bearer ${h}`}})}catch(e){console.error('Logout error:',e)}finally{await o.default.removeItem('session_token'),c(null),_(null)}}},children:e})},_=()=>{const e=(0,n.useContext)(f);if(!e)throw new Error('useAuth must be used within AuthProvider');return e}});","lineCount":1,"map":[[1,378,30,0,"Object"],[1,385,30,0,"defineProperty"],[1,400,30,0,"_e"],[1,403,30,0],[1,419,30,0,"enumerable"],[1,431,30,0],[1,433,30,0,"get"],[1,437,30,0],[1,455,30,0,"AuthProvider"],[1,456,30,0],[1,460,163,0,"Object"],[1,467,163,0,"defineProperty"],[1,482,163,0,"_e"],[1,485,163,0],[1,496,163,0,"enumerable"],[1,508,163,0],[1,510,163,0,"get"],[1,514,163,0],[1,532,163,0,"useAuth"],[1,533,163,0],[1,537,1,0],[1,541,1,0,"_react"],[1,543,1,0,"r"],[1,545,1,0,"_d"],[1,548,1,0],[1,552,2,0,"AsyncStorage"],[1,554,2,0,"_interopDefault"],[1,556,2,0,"r"],[1,558,2,0,"_d"],[1,561,2,0],[1,566,4,0,"Linking"],[1,569,3,0,"_interopNamespace"],[1,571,3,0,"r"],[1,573,3,0,"_d"],[1,576,3,0],[1,581,4,0,"_interopNamespace"],[1,583,4,0,"r"],[1,585,4,0,"_d"],[1,588,4,0],[1,594,4,40,"r"],[1,596,4,40,"_d"],[1,599,4,40],[1,603,6,0],[1,607,6,0,"axios"],[1,609,6,0,"_interopDefault"],[1,611,6,0,"r"],[1,613,6,0,"_d"],[1,616,6,0],[1,621,7,0,"Constants"],[1,623,7,0,"_interopDefault"],[1,625,7,0,"r"],[1,627,7,0,"_d"],[1,630,7,0],[1,635,7,39,"_reactJsxRuntime"],[1,637,7,39,"r"],[1,639,7,39,"_d"],[1,642,7,39],[1,646,9,0],[1,652,9,6,"BACKEND_URL"],[1,654,9,20,"Constants"],[1,656,9,29,"default"],[1,664,9,30,"expoConfig"],[1,676,9,42,"extra"],[1,683,9,49,"EXPO_PUBLIC_BACKEND_URL"],[1,713,9,72,"undefined"],[1,715,28,6,"AuthContext"],[1,718,28,20],[1,720,28,20,"createContext"],[1,722,28,33,"createContext"],[1,742,28,63,"undefined"],[1,745,30,13,"AuthProvider"],[1,747,30,28,"AuthProvider"],[1,749,30,31,"children"],[1,764,31,2],[1,770,31,9,"user"],[1,772,31,15,"setUser"],[1,776,31,26],[1,778,31,26,"useState"],[1,780,31,34,"useState"],[1,790,31,48],[1,797,32,9,"sessionToken"],[1,799,32,23,"setSessionToken"],[1,803,32,42],[1,805,32,42,"useState"],[1,807,32,50,"useState"],[1,817,32,66],[1,824,33,9,"loading"],[1,826,33,18,"setLoading"],[1,830,33,32],[1,832,33,32,"useState"],[1,834,33,40,"useState"],[1,845,33,41],[1,849,36,2],[1,851,36,2,"useEffect"],[1,853,36,11,"useEffect"],[1,864,36,12],[1,869,37,4,"checkExistingSession"],[1,874,38,5],[1,879,41,2],[1,881,41,2,"useEffect"],[1,883,41,11,"useEffect"],[1,894,41,12],[1,899,42,4],[1,905,46,10,"subscription"],[1,907,46,25,"Linking"],[1,909,46,33,"addEventListener"],[1,926,46,50],[1,932,42,27,"async"],[1,948,43,12,"processAuthCallback"],[1,950,43,32,"event"],[1,952,43,38,"url"],[1,959,55,4],[1,966,49,4,"Linking"],[1,968,49,12,"getInitialURL"],[1,984,49,28,"then"],[1,989,49,34,"url"],[1,993,50,10,"url"],[1,996,51,8,"processAuthCallback"],[1,998,51,28,"url"],[1,1003,55,11],[1,1008,56,6,"subscription"],[1,1010,56,19,"remove"],[1,1021,58,5],[1,1025,60,2],[1,1031,60,8,"checkExistingSession"],[1,1033,60,31,"async"],[1,1043,61,4],[1,1047,62,6],[1,1053,62,12,"token"],[1,1061,62,26,"AsyncStorage"],[1,1063,62,38,"default"],[1,1071,62,39,"getItem"],[1,1079,62,47],[1,1096,63,6],[1,1099,63,10,"token"],[1,1101,63,17],[1,1102,65,8],[1,1108,65,14,"response"],[1,1116,65,31,"axios"],[1,1118,65,36,"default"],[1,1126,65,37,"get"],[1,1130,65,41],[1,1133,65,44,"BACKEND_URL"],[1,1149,65,71],[1,1150,66,10,"headers"],[1,1158,66,19],[1,1159,66,21,"Authorization"],[1,1173,66,36],[1,1183,66,46,"token"],[1,1190,68,8,"setUser"],[1,1192,68,16,"response"],[1,1194,68,25,"data"],[1,1200,69,8,"setSessionToken"],[1,1202,69,24,"token"],[1,1204,70,6],[1,1205,71,4],[1,1206,71,6],[1,1212,71,13,"error"],[1,1215,72,6,"console"],[1,1223,72,14,"log"],[1,1227,72,18],[1,1259,73,12,"AsyncStorage"],[1,1261,73,24,"default"],[1,1269,73,25,"removeItem"],[1,1280,73,36],[1,1296,74,4],[1,1297,74,5],[1,1305,75,6,"setLoading"],[1,1308,75,17],[1,1310,76,4],[1,1313,79,8,"processAuthCallback"],[1,1315,79,30,"async"],[1,1325,80,4],[1,1329,82,6],[1,1335,82,12,"sessionIdMatch"],[1,1337,82,29,"url"],[1,1339,82,33,"match"],[1,1345,82,39],[1,1371,83,6],[1,1375,83,11,"sessionIdMatch"],[1,1377,83,27],[1,1384,85,6],[1,1390,85,12,"sessionId"],[1,1392,85,24,"sessionIdMatch"],[1,1394,85,39],[1,1397,86,6,"setLoading"],[1,1400,86,17],[1,1403,89,6],[1,1409,89,12,"response"],[1,1417,89,29,"axios"],[1,1419,89,34,"default"],[1,1427,89,35,"post"],[1,1432,90,8],[1,1435,90,11,"BACKEND_URL"],[1,1456,91,8],[1,1457,91,9],[1,1459,92,8],[1,1460,92,10,"headers"],[1,1468,92,19],[1,1469,92,21],[1,1484,92,37,"sessionId"],[1,1490,95,12,"session_token"],[1,1504,95,14,"session_token"],[1,1506,95,27,"user_id"],[1,1514,95,29,"user_id"],[1,1516,95,36,"email"],[1,1522,95,38,"email"],[1,1524,95,43,"name"],[1,1529,95,45,"name"],[1,1531,95,49,"picture"],[1,1539,95,51,"picture"],[1,1541,95,58,"role"],[1,1546,95,60,"role"],[1,1549,95,69,"response"],[1,1551,95,78,"data"],[1,1562,98,12,"AsyncStorage"],[1,1564,98,24,"default"],[1,1572,98,25,"setItem"],[1,1580,98,33],[1,1596,98,50,"session_token"],[1,1599,99,6,"setSessionToken"],[1,1601,99,22,"session_token"],[1,1604,100,6,"setUser"],[1,1606,100,14],[1,1607,100,16,"user_id"],[1,1617,100,25,"email"],[1,1625,100,32,"name"],[1,1632,100,38,"picture"],[1,1642,100,47,"role"],[1,1651,104,28],[1,1666,103,34,"AsyncStorage"],[1,1668,103,46,"default"],[1,1676,103,47,"getItem"],[1,1684,103,55],[1,1717,105,14,"AsyncStorage"],[1,1719,105,26,"default"],[1,1727,105,27,"removeItem"],[1,1738,105,38],[1,1763,108,4],[1,1764,108,6],[1,1770,108,13,"error"],[1,1773,109,6,"console"],[1,1781,109,14,"error"],[1,1787,109,20],[1,1810,109,44,"error"],[1,1812,110,4],[1,1813,110,5],[1,1821,111,6,"setLoading"],[1,1824,111,17],[1,1826,112,4],[1,1829,154,8,"isGuest"],[1,1832,154,19,"user"],[1,1836,154,28,"loading"],[1,1838,156,2],[1,1845,157,4],[1,1847,157,4,"_reactJsxRuntime"],[1,1849,157,4,"jsx"],[1,1854,157,5,"AuthContext"],[1,1856,157,17,"Provider"],[1,1865,157,25],[1,1866,157,26,"value"],[1,1872,157,33],[1,1873,157,35,"user"],[1,1880,157,41,"sessionToken"],[1,1895,157,55,"loading"],[1,1905,157,64,"isGuest"],[1,1915,157,73,"login"],[1,1921,115,16,"async"],[1,1931,116,4],[1,1935,117,6],[1,1941,117,12,"redirectUrl"],[1,1943,118,10],[1,1946,118,13,"BACKEND_URL"],[1,1951,121,12,"authUrl"],[1,1953,121,22],[1,1997,121,66,"encodeURIComponent"],[1,2016,121,85,"redirectUrl"],[1,2021,124,8,"window"],[1,2028,124,15,"location"],[1,2037,124,24,"href"],[1,2042,124,31,"authUrl"],[1,2043,131,4],[1,2044,131,6],[1,2050,131,13,"error"],[1,2053,132,6,"console"],[1,2061,132,14,"error"],[1,2067,132,20],[1,2082,132,36,"error"],[1,2084,133,4],[1,2087,157,80,"logout"],[1,2094,136,17,"async"],[1,2104,137,4],[1,2108,138,10,"sessionToken"],[1,2117,139,14,"axios"],[1,2119,139,19,"default"],[1,2127,139,20,"post"],[1,2132,140,10],[1,2135,140,13,"BACKEND_URL"],[1,2155,141,10],[1,2156,141,11],[1,2158,142,10],[1,2159,142,12,"headers"],[1,2167,142,21],[1,2168,142,23,"Authorization"],[1,2182,142,38],[1,2192,142,48,"sessionToken"],[1,2198,145,4],[1,2199,145,6],[1,2205,145,13,"error"],[1,2208,146,6,"console"],[1,2216,146,14,"error"],[1,2222,146,20],[1,2238,146,37,"error"],[1,2240,147,4],[1,2241,147,5],[1,2255,148,12,"AsyncStorage"],[1,2257,148,24,"default"],[1,2265,148,25,"removeItem"],[1,2276,148,36],[1,2293,149,6,"setUser"],[1,2295,149,14],[1,2301,150,6,"setSessionToken"],[1,2303,150,22],[1,2308,151,4],[1,2312,157,89,"children"],[1,2321,158,7,"children"],[1,2326,163,13,"useAuth"],[1,2328,163,23,"useAuth"],[1,2333,164,2],[1,2339,164,8,"context"],[1,2342,164,18],[1,2344,164,18,"useContext"],[1,2346,164,28,"useContext"],[1,2358,164,29,"AuthContext"],[1,2361,165,2],[1,2365,165,7,"context"],[1,2367,166,4],[1,2373,166,10],[1,2377,166,14,"Error"],[1,2383,166,20],[1,2427,168,2],[1,2434,168,9,"context"],[1,2436,169,2],[1,2439]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","handleDeepLink","Linking.getInitialURL.then$argument_0","<anonymous>","checkExistingSession","processAuthCallback","login","logout","useAuth"],"mappings":"AAA;4BC6B;YCM;GDE;YCG;2BCC;KDE;iCEK;KFI;WGE;KHE;GDC;+BKE;GLiB;8BME;GNkC;gBOE;GPmB;iBQE;GRgB;CDS;uBUE;CVM"},"hasCjsExports":false},"type":"js/module"}]}